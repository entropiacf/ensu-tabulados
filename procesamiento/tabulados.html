<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tabulados ENSU</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="tabulados_files/libs/clipboard/clipboard.min.js"></script>
<script src="tabulados_files/libs/quarto-html/quarto.js"></script>
<script src="tabulados_files/libs/quarto-html/popper.min.js"></script>
<script src="tabulados_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tabulados_files/libs/quarto-html/anchor.min.js"></script>
<link href="tabulados_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tabulados_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tabulados_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tabulados_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tabulados_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tabulados ENSU</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>La Encuesta Nacional de Seguridad Pública Urbana (ENSU) 2024 es un proyecto estadístico destinado para enriquecer la oferta de información de interés nacional vinculada al Subsistema Nacional de Información de Gobierno, Seguridad Pública e Impartición de Justicia.</p>
<p>La encuesta se llevó a cabo con la finalidad de obtener información que permita realizar estimaciones sobre la percepción de la población acerca de la seguridad pública en su ciudad, tanto a nivel nacional como en cada una de las áreas urbanas (ciudades) de interés.</p>
<p>Para mayor información y descarga de datos, cuestionarios, etcétera visite el enlace: <a href="h#ttps://www.inegi.org.mx/programas/ensu/">ENSU</a></p>
<section id="carga-de-bibliotecas" class="level3">
<h3 class="anchored" data-anchor-id="carga-de-bibliotecas">Carga de bibliotecas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="co">#Rcpp, remotes,  </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               kable, readr, tidyr, dplyr, janitor, srvyr, here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/home/isaias/R/x86_64-pc-linux-gnu-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'kable' is not available for this version of R

A version of this package for your version of R might be available elsewhere,
see the ideas at
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'BiocManager' not available.  Could not check Bioconductor.

Please use `install.packages('BiocManager')` and then retry.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in p_install(package, character.only = TRUE, ...):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'kable'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pacman::p_load(kable, readr, tidyr, dplyr, janitor, srvyr, here): Failed to install/load:
kable</code></pre>
</div>
</div>
</section>
<section id="carga-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="carga-de-datos">Carga de datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ensu <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>( <span class="st">'datos/datos-originales/ENSU_CB_0924.csv'</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 24096 Columns: 245
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (35): ID_VIV, ID_PER, UPM, VIV_SEL, R_SEL, ID_VIVT, ID_PERT, CVE_ENT, N...
dbl (207): H_MUD, S_MUD, N_ENT, SEXO, EDAD, BP1_1, BP1_2_01, BP1_2_02, BP1_2...
lgl   (3): BP4_4_5_3, BP4_4_6_2, BP4_4_6_3

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="limpieza-de-datos-y-recodificación-de-variables" class="level3">
<h3 class="anchored" data-anchor-id="limpieza-de-datos-y-recodificación-de-variables">Limpieza de datos y recodificación de variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ensu <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(ensu)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ensu <span class="ot">&lt;-</span> ensu <span class="sc">|&gt;</span> <span class="co">#filter(bp1_1 != 9) |&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bp1_1_dis =</span> <span class="fu">ifelse</span>( bp1_1 <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">sexo =</span> <span class="fu">ifelse</span>( sexo <span class="sc">==</span> <span class="dv">1</span>, <span class="st">'Hombres'</span>,<span class="st">'Mujeres'</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="trabajar-con-el-diseño-muestral" class="level3">
<h3 class="anchored" data-anchor-id="trabajar-con-el-diseño-muestral">Trabajar con el Diseño muestral</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hay problemas con UPM únicas, en mi caso decido removerlas, pero hay otros métodos</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"remove"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un objeto que guarde el diseño muestral.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>dis_m <span class="ot">&lt;-</span> ensu <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(<span class="at">ids =</span> upm,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">strata=</span>est_dis,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights=</span> fac_sel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comencemos-a-calcular-un-tabulado." class="level3">
<h3 class="anchored" data-anchor-id="comencemos-a-calcular-un-tabulado.">Comencemos a Calcular un Tabulado.</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagenes-aux/pregunta-percepcion.png" class="img-fluid figure-img"></p>
<figcaption>Con esta pregunta se puede calcular la percepción de seguridad de las personas en cuánto a la Ciudad</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la estimación para percepción de seguridad</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dis_m <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">percepcion =</span>  <span class="fu">survey_mean</span> (bp1_1_dis,  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">"cv"</span>, <span class="st">"ci"</span>), </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">level=</span><span class="fl">0.9</span>, <span class="co"># El diseño muestral está definido al 90 % de confianza</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">proportion =</span> T) )  <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">percepcion</th>
<th style="text-align: right;">percepcion_cv</th>
<th style="text-align: right;">percepcion_low</th>
<th style="text-align: right;">percepcion_upp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5863314</td>
<td style="text-align: right;">0.0075711</td>
<td style="text-align: right;">0.5790098</td>
<td style="text-align: right;">0.5936151</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="agreguemos-la-variable-sexo" class="level1">
<h1>Agreguemos la variable Sexo</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la estimación para percepción de seguridad</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dis_m <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">percepcion =</span>  <span class="fu">survey_mean</span> (bp1_1_dis,  </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">"cv"</span>, <span class="st">"ci"</span>), </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">level=</span><span class="fl">0.9</span>, <span class="co"># El diseño muestral está definido al 90 % de confianza</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">proportion =</span> T) ) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">sexo</th>
<th style="text-align: right;">percepcion</th>
<th style="text-align: right;">percepcion_cv</th>
<th style="text-align: right;">percepcion_low</th>
<th style="text-align: right;">percepcion_upp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hombres</td>
<td style="text-align: right;">0.5223602</td>
<td style="text-align: right;">0.0129891</td>
<td style="text-align: right;">0.5111883</td>
<td style="text-align: right;">0.5335097</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mujeres</td>
<td style="text-align: right;">0.6398314</td>
<td style="text-align: right;">0.0089746</td>
<td style="text-align: right;">0.6303313</td>
<td style="text-align: right;">0.6492232</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="en-la-imagen-se-pueden-contrastar-los-resultados-por-sexo." class="level3">
<h3 class="anchored" data-anchor-id="en-la-imagen-se-pueden-contrastar-los-resultados-por-sexo.">En la imagen se pueden contrastar los resultados por sexo.</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagenes-aux/ensu-percepcion.png" class="img-fluid figure-img"></p>
<figcaption>Gráfica del reporte de INEGI, tercer trimestre ENSU.</figcaption>
</figure>
</div>
</section>
</section>
<section id="ahora-por-ciudad-top-15-ciudades-en-las-que-se-sienten-seguras" class="level1">
<h1>Ahora por Ciudad, Top 15 Ciudades en las que se sienten seguras</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Por ciudad </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dis_m <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>( nom_ent, nom_cd) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">perc_ciudad =</span> <span class="fu">survey_mean</span>(bp1_1_dis,  </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">'perc_ciudad'</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">"cv"</span>, <span class="st">"ci"</span>), <span class="at">level=</span><span class="fl">0.9</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">proportion =</span> T) ) <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nom_ent, nom_cd, perc_ciudad) <span class="sc">|&gt;</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(perc_ciudad) <span class="sc">|&gt;</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 15 de Ciudades con mejor percepción de seguridad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 15 de Ciudades con mejor percepción de seguridad</caption>
<colgroup>
<col style="width: 46%">
<col style="width: 36%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">nom_ent</th>
<th style="text-align: left;">nom_cd</th>
<th style="text-align: right;">perc_ciudad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NUEVO LEON</td>
<td style="text-align: left;">SAN PEDRO GARZA GARCIA</td>
<td style="text-align: right;">0.1369015</td>
</tr>
<tr class="even">
<td style="text-align: left;">CIUDAD DE MEXICO</td>
<td style="text-align: left;">BENITO JUAREZ</td>
<td style="text-align: right;">0.1753425</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TAMAULIPAS</td>
<td style="text-align: left;">TAMPICO</td>
<td style="text-align: right;">0.1925714</td>
</tr>
<tr class="even">
<td style="text-align: left;">COAHUILA DE ZARAGOZA</td>
<td style="text-align: left;">PIEDRAS NEGRAS</td>
<td style="text-align: right;">0.2022170</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JALISCO</td>
<td style="text-align: left;">PUERTO VALLARTA</td>
<td style="text-align: right;">0.2126129</td>
</tr>
<tr class="even">
<td style="text-align: left;">COAHUILA DE ZARAGOZA</td>
<td style="text-align: left;">SALTILLO</td>
<td style="text-align: right;">0.2167097</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BAJA CALIFORNIA SUR</td>
<td style="text-align: left;">LOS CABOS</td>
<td style="text-align: right;">0.2289039</td>
</tr>
<tr class="even">
<td style="text-align: left;">SINALOA</td>
<td style="text-align: left;">LOS MOCHIS</td>
<td style="text-align: right;">0.2345692</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NAYARIT</td>
<td style="text-align: left;">TEPIC</td>
<td style="text-align: right;">0.2369827</td>
</tr>
<tr class="even">
<td style="text-align: left;">YUCATAN</td>
<td style="text-align: left;">MERIDA</td>
<td style="text-align: right;">0.2460187</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BAJA CALIFORNIA SUR</td>
<td style="text-align: left;">LA PAZ</td>
<td style="text-align: right;">0.2590390</td>
</tr>
<tr class="even">
<td style="text-align: left;">NUEVO LEON</td>
<td style="text-align: left;">SAN NICOLAS DE LOS GARZA</td>
<td style="text-align: right;">0.2857975</td>
</tr>
<tr class="odd">
<td style="text-align: left;">COAHUILA DE ZARAGOZA</td>
<td style="text-align: left;">LA LAGUNA</td>
<td style="text-align: right;">0.3081418</td>
</tr>
<tr class="even">
<td style="text-align: left;">CIUDAD DE MEXICO</td>
<td style="text-align: left;">CUAJIMALPA DE MORELOS</td>
<td style="text-align: right;">0.3157562</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VERACRUZ DE IGNACIO DE LA LLAVE</td>
<td style="text-align: left;">TAMPICO</td>
<td style="text-align: right;">0.3251895</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ahora-por-ciudad-top-15-ciudades-en-las-que-se-sienten-inseguras" class="level1">
<h1>Ahora por Ciudad, Top 15 Ciudades en las que se sienten inseguras</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Por ciudad </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>dis_m <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nom_ent, nom_cd) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">perc_ciudad =</span> <span class="fu">survey_mean</span>(bp1_1_dis,  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">'perc_ciudad'</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">"cv"</span>, <span class="st">"ci"</span>), <span class="at">level=</span><span class="fl">0.9</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">proportion =</span> T) ) <span class="sc">|&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nom_ent,nom_cd, perc_ciudad) <span class="sc">|&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>perc_ciudad) <span class="sc">|&gt;</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 15 de Ciudades con menor percepción de seguridad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 15 de Ciudades con menor percepción de seguridad</caption>
<colgroup>
<col style="width: 45%">
<col style="width: 37%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">nom_ent</th>
<th style="text-align: left;">nom_cd</th>
<th style="text-align: right;">perc_ciudad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CHIAPAS</td>
<td style="text-align: left;">TAPACHULA</td>
<td style="text-align: right;">0.9189024</td>
</tr>
<tr class="even">
<td style="text-align: left;">MEXICO</td>
<td style="text-align: left;">NAUCALPAN DE JUAREZ</td>
<td style="text-align: right;">0.8799448</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ZACATECAS</td>
<td style="text-align: left;">FRESNILLO</td>
<td style="text-align: right;">0.8792162</td>
</tr>
<tr class="even">
<td style="text-align: left;">MEXICO</td>
<td style="text-align: left;">ECATEPEC DE MORELOS</td>
<td style="text-align: right;">0.8702599</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GUANAJUATO</td>
<td style="text-align: left;">IRAPUATO</td>
<td style="text-align: right;">0.8641934</td>
</tr>
<tr class="even">
<td style="text-align: left;">CHIAPAS</td>
<td style="text-align: left;">TUXTLA GUTIERREZ</td>
<td style="text-align: right;">0.8585895</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MICHOACAN DE OCAMPO</td>
<td style="text-align: left;">URUAPAN</td>
<td style="text-align: right;">0.8554566</td>
</tr>
<tr class="even">
<td style="text-align: left;">MORELOS</td>
<td style="text-align: left;">CUERNAVACA</td>
<td style="text-align: right;">0.8347550</td>
</tr>
<tr class="odd">
<td style="text-align: left;">COLIMA</td>
<td style="text-align: left;">COLIMA</td>
<td style="text-align: right;">0.8142759</td>
</tr>
<tr class="even">
<td style="text-align: left;">MEXICO</td>
<td style="text-align: left;">CUAUTITLAN IZCALLI</td>
<td style="text-align: right;">0.8051667</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GUERRERO</td>
<td style="text-align: left;">CHILPANCINGO DE LOS BRAVO</td>
<td style="text-align: right;">0.7956852</td>
</tr>
<tr class="even">
<td style="text-align: left;">GUANAJUATO</td>
<td style="text-align: left;">LEON DE LOS ALDAMA</td>
<td style="text-align: right;">0.7907319</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TABASCO</td>
<td style="text-align: left;">VILLAHERMOSA</td>
<td style="text-align: right;">0.7874809</td>
</tr>
<tr class="even">
<td style="text-align: left;">ZACATECAS</td>
<td style="text-align: left;">ZACATECAS</td>
<td style="text-align: right;">0.7854928</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VERACRUZ DE IGNACIO DE LA LLAVE</td>
<td style="text-align: left;">COATZACOALCOS</td>
<td style="text-align: right;">0.7787854</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="en-la-imagen-se-pueden-contrastar-los-resultados." class="level3">
<h3 class="anchored" data-anchor-id="en-la-imagen-se-pueden-contrastar-los-resultados.">En la imagen se pueden contrastar los resultados.</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagenes-aux/ensu-mapa.png" class="img-fluid figure-img"></p>
<figcaption>Mapa del reporte de INEGI, tercer trimestre ENSU.</figcaption>
</figure>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>